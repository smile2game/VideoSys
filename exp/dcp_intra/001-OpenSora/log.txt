[2024-12-24 13:14:35] [INFO] [train.py:70:main]   Experiment directory created at exp/dcp_intra/001-OpenSora
[2024-12-24 13:14:35] [INFO] [train.py:71:main]   Training configuration:
 {'adam_eps': 1e-15,
 'alloc_memory_fraction': 0.7,
 'auto_grad_accumulation': False,
 'batch_size': None,
 'bucket_config': {'144p': {1: [1.0, 345],
                            51: [1.0, 48],
                            102: [1.0, 25],
                            204: [1.0, 12],
                            408: [1.0, 6]},
                   '240p': {1: [1.0, 128],
                            51: [1.0, 16],
                            102: [1.0, 8],
                            204: [1.0, 4],
                            408: [1.0, 2]},
                   '360p': {1: [1.0, 64],
                            51: [1.0, 7],
                            102: [1.0, 4],
                            204: [1.0, 2],
                            408: [1.0, 1]},
                   '480p': {1: [1.0, 32],
                            51: [1.0, 4],
                            102: [1.0, 2],
                            204: [1.0, 1],
                            408: [1.0, 1]},
                   '720p': {1: [1.0, 14],
                            51: [1.0, 1],
                            102: [1.0, 1],
                            204: [1.0, 1],
                            408: [1.0, 1]}},
 'calculate_imbalance': True,
 'ckpt_every': -1,
 'ckpt_path': 'hpcai-tech/OpenSora-STDiT-v3',
 'common_ar': {'144p': {'0.56': [144, 256]},
               '240p': {'0.56': [240, 426]},
               '360p': {'0.56': [360, 640]},
               '480p': {'0.56': [480, 854]},
               '720p': {'0.56': [720, 1280]}},
 'config': 'examples/training/open_sora/configs/benchmarks/dcp_intra.yaml',
 'data_path': './assets/example_data/demo_preprocess.csv',
 'distributed_profile': False,
 'distribution': 'zipf',
 'drop_last': True,
 'dtype': 'bf16',
 'dummy_data_size': 2000,
 'dummy_dataset': True,
 'dynamic_recompute': False,
 'dynamic_sp': True,
 'ema_decay': 0.99,
 'epochs': 1,
 'grad_checkpoint': True,
 'grad_clip': 1.0,
 'image_mixing_frac': 50,
 'image_mixing_type': 'exclusive',
 'load': None,
 'log_every': 10000000000.0,
 'lr': 1e-08,
 'mask_ratios': {'image_head': 0.22,
                 'image_head_tail': 0.005,
                 'image_random': 0.0,
                 'image_tail': 0.005,
                 'intepolate': 0.002,
                 'quarter_head': 0.002,
                 'quarter_head_tail': 0.002,
                 'quarter_random': 0.002,
                 'quarter_tail': 0.002,
                 'random': 0.01},
 'max_grad_accumulation_steps': 3,
 'min_grad_accumulation_steps': 2,
 'no_global_interpolation': False,
 'num_bucket_build_workers': 16,
 'num_workers': 8,
 'outputs': 'exp/dcp_intra',
 'prefetch_factor': 2,
 'preprocessed_data': True,
 'profile_path': 'exp/profile/dcp_intra',
 'reduce_bucket_size_in_m': 20,
 'save_optimizer': False,
 'seed': 42,
 'sp_size': 1,
 'start_from_scratch': False,
 'verbose': True,
 'wandb': False,
 'warmup_steps': 10,
 'weight_decay': 0,
 'zipf_offset': 5}
[2024-12-24 13:14:35] [INFO] [parallel_mgr.py:66:__init__]   Init dynamic parallel manager with world size: 2
[2024-12-24 13:14:35] [INFO] [train.py:86:main]   [ATTENTION!] Profile file is not found at `exp/profile/dcp_intra`! Profiling will be performed then exit.
[2024-12-24 13:14:35] [INFO] [train.py:95:main]   Building models...
